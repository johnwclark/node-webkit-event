<!DOCTYPE html>
<html>
  <head>
    <title>Hello World!</title>
  </head>

<style>
.foo{ border:solid 1px #000; width:300px; height:300px; }
</style>
  <body>

<script>
function openIndexWindow() {
    window.location.assign('index.html');
}
</script>
<input type='button' value='back to index' onclick='openIndexWindow()'>

<script type="text/javascript" src="./js/jquery.min.js"></script>
<script src="./js/raphael-min.js"></script>
<!--
-->

<div id="drawArea" class="foo"></div>

<script>

var raf = {};
var rafW = 300;
var rafH = 300;
raf.paper = new Raphael('drawArea', rafW, rafH);
console.log('rafW =' + rafH + ' rafW = ' + rafH);

// added a rectangle
raf.rect1 = raf.paper.rect(10, 10, 30, 30);
raf.rect1.attr({
    fill: 'azure'
});
raf.rect1.click( function () {
    console.log('click rectangle');
});


// line drawing
var lineDraw = false;
function LineDrawToggle() {
    lineDraw = !lineDraw;
    console.log('lineDraw =' + lineDraw);
};

// mousedown sets the start point
var startX = null;
var startY = null;
var line = {};
$('#drawArea').mousedown( function(e) {
    console.log('mousedown');
    if ( lineDraw ) {
        console.log('starting new line');
        startX = e.offsetX;
        startY = e.offsetY;
        line = raf.paper.path( "" );
    }
});

// mouseup sets the end point
$('#drawArea').mouseup( function(e) {
    console.log('mouseup');
    if ( lineDraw ) {
        var endX = e.offsetX;
        var endY = e.offsetY;
        var pathStr = "M" + startX + " " + startY + " L" + endX + " " + endY;
        console.log('path = ' + pathStr);
        line = raf.paper.path( pathStr );
        startX = null;
        startY = null;
    }
});

// mousemove changes the end point
$('#drawArea').mousemove( function(e) {
    if ( lineDraw && startX ) {
        console.log('redrawing line');
        var endX = e.offsetX;
        var endY = e.offsetY;
        var pathStr = "M" + startX + " " + startY + " L" + endX + " " + endY;
        console.log('path = ' + pathStr);
        // change the attr for the line
        line.attr("path", pathStr );
    }
});

</script>
<input type='button' value='line draw toggle' onclick='LineDrawToggle()'>

  </body>
</html>

